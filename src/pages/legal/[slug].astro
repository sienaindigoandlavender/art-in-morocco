---
import Base from '../../layouts/Base.astro';
import { getNexusLegalPages, getNexusLegalPage } from '../../lib/supabase';

export async function getStaticPaths() {
  const pages = await getNexusLegalPages();
  return pages.map(p => ({ params: { slug: p.page_id }, props: { pageTitle: p.page_title } }));
}

const { slug } = Astro.params;
const { pageTitle } = Astro.props;
const sections = await getNexusLegalPage(slug!);
---

<Base title={`${pageTitle} â€” Morocco Art Guide`}>
  <div class="section-inner">
    <div class="page-header" style="text-align: left;">
      <span class="micro-label">Legal</span>
      <h1>{pageTitle}</h1>
    </div>

    <div class="legal-content">
      {sections.map(s => (
        <section class="legal-section">
          <h2>{s.section_title}</h2>
          <div set:html={s.section_content.replace(/\n/g, '<br>')} />
        </section>
      ))}
    </div>
  </div>
</Base>

<style>
  .legal-content { max-width: var(--max-width-narrow); }
  .legal-section { margin-bottom: var(--space-lg); }
  .legal-section h2 { font-size: 1.2rem; margin-bottom: var(--space-sm); }
  .legal-section div { font-size: 0.92rem; line-height: 1.7; color: var(--color-ink-light); }
</style>
